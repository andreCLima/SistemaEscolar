@page "/home"
@rendermode InteractiveServer
@using SistemaEscolarWeb.Services
@using SistemaEscolarWeb.Models
@inject EscolaService EscolaService

<PageTitle>Home</PageTitle>

<div class="container-fluid">
    <div class="jumbotron bg-primary text-white p-5 rounded mb-4">
        <h1 class="display-4">Sistema Escolar</h1>
        <p class="lead">Bem-vindo ao sistema de gerenciamento escolar</p>
        <hr class="my-4">
        <p>Gerencie turmas, estudantes, diários e muito mais de forma simples e eficiente.</p>
    </div>

    <div class="row">
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <i class="bi bi-building display-4 text-primary"></i>
                    <h5 class="card-title mt-2">Séries</h5>
                    <h3 class="text-primary">@escola.Series.Count</h3>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <i class="bi bi-people display-4 text-success"></i>
                    <h5 class="card-title mt-2">Turmas</h5>
                    <h3 class="text-success">@totalTurmas</h3>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <i class="bi bi-person display-4 text-info"></i>
                    <h5 class="card-title mt-2">Estudantes</h5>
                    <h3 class="text-info">@totalEstudantes</h3>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <i class="bi bi-journal-text display-4 text-warning"></i>
                    <h5 class="card-title mt-2">Diários</h5>
                    <h3 class="text-warning">@totalDiarios</h3>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Acesso Rápido</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <a href="/escola" class="btn btn-outline-primary btn-lg w-100 mb-3">
                                <i class="bi bi-building"></i><br/>
                                <span>Escola</span>
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="/turmaTeste" class="btn btn-outline-success btn-lg w-100 mb-3">
                                <i class="bi bi-people"></i><br/>
                                <span>Turmas</span>
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="/diario" class="btn btn-outline-info btn-lg w-100 mb-3">
                                <i class="bi bi-journal-text"></i><br/>
                                <span>Diários</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private Escola escola = new();
    private int totalTurmas = 0;
    private int totalEstudantes = 0;
    private int totalDiarios = 0;

    protected override void OnInitialized()
    {
        escola = EscolaService.GetEscola();
        totalTurmas = escola.Series.Sum(s => s.Turmas.Count);
        totalEstudantes = escola.Series.Sum(s => s.Turmas.Sum(t => t.Estudantes.Count));
        totalDiarios = escola.Series.Sum(s => s.Turmas.Sum(t => t.Diarios.Count));
    }
}
